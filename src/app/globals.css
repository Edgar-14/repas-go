@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

/**********************************************
 * Global Theme, Utilities and Responsive System
 * Limpieza de overrides agresivos y utilidades opt-in
 **********************************************/

@layer base {
  :root {
    /* BeFast Brand Colors */
    --befast-primary: #FF7300;
    --befast-secondary: #1657F0;
    --befast-tertiary: #36D7E0;
    --befast-dark: #232A36;
    --befast-light: #EBECF0;

    /* Design tokens base */
    --background: #EBECF0;
    --foreground: #232A36;
    --card: #EBECF0;
    --card-foreground: #232A36;
    --popover: #EBECF0;
    --popover-foreground: #232A36;

    /* Primary (Orange) */
    --primary: 28 100% 47%; /* #FF7300 */
    --primary-foreground: 210 20% 98%;

    /* Secondary (Blue) */
    --secondary: 217 89% 61%; /* #1657F0 */
    --secondary-foreground: 210 20% 98%;

    /* Muted */
    --muted: 220 14.3% 95.9%;
    --muted-foreground: 220 8.9% 46.1%;

    /* Accent (Cyan) */
    --accent: 187 100% 55%; /* #36D7E0 */
    --accent-foreground: 222.2 47.4% 11.2%;

    /* Destructive */
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 20% 98%;

    /* Border */
    --border: 220 13% 91%;
    --input: 220 13% 91%;
    --ring: 217 89% 61%;

    /* Neumorphic shadows */
    --shadow-light: #ffffff;
    --shadow-dark: rgba(72, 79, 96, 0.4);

    /* Radius */
    --radius: 0.5rem;

    /* Chart colors */
    --chart-1: 28 100% 47%;
    --chart-2: 217 89% 61%;
    --chart-3: 187 100% 55%;
    --chart-4: 224 71.4% 4.1%;
    --chart-5: 340 75% 55%;
  }

  .dark {
    /* Dark theme colors */
    --background: #0f1419;
    --foreground: #e6e8eb;
    --card: #1a1f2e;
    --card-foreground: #e6e8eb;
    --popover: #1a1f2e;
    --popover-foreground: #e6e8eb;
    --primary: 28 100% 47%;
    --primary-foreground: 210 20% 98%;
    --secondary: 217 89% 61%;
    --secondary-foreground: 210 20% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 187 100% 55%;
    --accent-foreground: 210 20% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 20% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 217 89% 61%;
    --shadow-light: rgba(255, 255, 255, 0.05);
    --shadow-dark: rgba(0, 0, 0, 0.8);
    
    /* BeFast Brand Colors for dark mode */
    --befast-primary: #FF7300;
    --befast-secondary: #1657F0;
    --befast-tertiary: #36D7E0;
    --befast-dark: #e6e8eb;
    --befast-light: #1a1f2e;
  }
}

@layer base {
  * {
    @apply border-border;
    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform;
    transition-duration: 200ms;
    transition-timing-function: ease-in-out;
  }

  body {
    @apply bg-background text-foreground;
    font-family: 'Montserrat', sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-feature-settings: "rlig" 1, "calt" 1;
  }
}

@layer components {
  /* Neumorphic Styles */
  .shadow-neumorphism {
    box-shadow: 8px 8px 16px var(--shadow-dark), -8px -8px 16px var(--shadow-light);
  }
  .shadow-neumorphism-inset {
    box-shadow: inset 8px 8px 16px var(--shadow-dark), inset -8px -8px 16px var(--shadow-light);
  }
  .shadow-neumorphic {
    box-shadow: 8px 8px 12px -2px rgba(72, 79, 96, 0.4), -6px -6px 12px -1px rgba(255, 255, 255, 1);
  }
  .shadow-neumorphic-hover {
    box-shadow: 12px 12px 20px -4px rgba(72, 79, 96, 0.5), -8px -8px 16px -2px rgba(255, 255, 255, 1);
  }
  .shadow-neumorphic-pressed {
    box-shadow: inset 4px 4px 8px rgba(72, 79, 96, 0.3), inset -4px -4px 8px rgba(255, 255, 255, 0.8);
  }

  /* Brand Gradients */
  .bg-befast-gradient { background: linear-gradient(135deg, var(--befast-primary) 0%, var(--befast-secondary) 100%); }
  .bg-befast-gradient-reverse { background: linear-gradient(135deg, var(--befast-secondary) 0%, var(--befast-primary) 100%); }
  .bg-befast-tertiary-gradient { background: linear-gradient(135deg, var(--befast-tertiary) 0%, var(--befast-secondary) 100%); }
  .text-befast-gradient {
    background: linear-gradient(135deg, var(--befast-primary) 0%, var(--befast-secondary) 100%);
    -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
  }

  /* Portal Theme Tokens */
  .portal-admin { --portal-primary: var(--befast-dark); --portal-secondary: var(--befast-secondary); --portal-accent: var(--befast-tertiary); }
  .portal-delivery { --portal-primary: var(--befast-primary); --portal-secondary: var(--befast-secondary); --portal-accent: var(--befast-tertiary); }
  .portal-driver { --portal-primary: var(--befast-secondary); --portal-secondary: var(--befast-primary); --portal-accent: var(--befast-tertiary); }

  /* Animations */
  .animate-float { animation: float 3s ease-in-out infinite; }
  .animate-pulse-glow { animation: pulse-glow 2s ease-in-out infinite alternate; }
  .animate-neumorphic-pop { animation: neumorphic-pop 0.3s ease-out; }

  /* Dark mode chat styles */
  .dark .chat-widget {
    @apply bg-gray-900 border-gray-700;
  }
  
  .dark .chat-message-bot {
    @apply bg-gray-800 border-gray-700 text-gray-100;
  }
  
  .dark .chat-message-user {
    /* User messages keep their brand colors in dark mode */
  }
  
  .dark .chat-input {
    @apply bg-gray-800 border-gray-700 text-gray-100;
  }
  
  .dark .chat-suggestions {
    @apply bg-gray-800 border-gray-700;
  }
  
  .dark .quick-action-button {
    @apply bg-gray-800 border-gray-600 text-gray-200 hover:bg-gray-700;
  }

  /* Responsive Tables */
  .table-responsive { @apply w-full overflow-x-auto; }
  .table-responsive table { @apply min-w-full; }
  @media (max-width: 768px) {
    .table-responsive table { @apply text-xs; }
    .table-responsive th, .table-responsive td { @apply px-1 py-1; }
    .table-responsive th:not(:first-child), .table-responsive td:not(:first-child) { @apply hidden sm:table-cell; }
    .table-responsive .mobile-priority { @apply table-cell; }
  }
  @media (max-width: 640px) {
    .table-stacked { @apply block; }
    .table-stacked thead { @apply hidden; }
    .table-stacked tbody { @apply block; }
    .table-stacked tr { @apply block mb-4 border border-gray-200 rounded-lg p-3 bg-white shadow-sm; }
    .table-stacked td { @apply block px-3 py-2 text-sm border-b border-gray-100 last:border-b-0; }
    .table-stacked td::before { @apply content-[attr(data-label)] font-medium text-gray-600 text-xs uppercase block mb-1; }
  }

  /* Mobile-friendly Buttons and Touch Targets */
  .btn-mobile { @apply min-h-[48px] px-4 py-3 text-sm sm:text-base; }
  @media (max-width: 768px) {
    .btn-mobile { @apply w-full text-base px-6 py-4; }
    .btn-mobile-sm { @apply min-h-[44px] px-4 py-2 text-sm; }
  }
  .touch-target { @apply min-h-[44px] min-w-[44px]; }
  .touch-target-lg { @apply min-h-[48px] min-w-[48px]; }

  /* Responsive text */
  .text-responsive-xl { @apply text-xl sm:text-2xl lg:text-3xl; }
  .text-responsive-lg { @apply text-lg sm:text-xl lg:text-2xl; }
  .text-responsive-md { @apply text-base sm:text-lg lg:text-xl; }
  .text-responsive-sm { @apply text-sm sm:text-base lg:text-lg; }

  /* Mobile navigation */
  .nav-mobile { @apply fixed inset-x-0 top-0 z-50 bg-white shadow-lg transform transition-transform duration-300; }
  .nav-mobile.closed { @apply -translate-y-full; }
  .nav-mobile.open { @apply translate-y-0; }

  /* Cards */
  .card-mobile { @apply bg-white rounded-lg shadow-sm border border-gray-200; }
  .card-mobile-header { @apply px-4 py-3 border-b border-gray-200; }
  .card-mobile-content { @apply px-4 py-3; }
  .card-mobile-footer { @apply px-4 py-3 border-t border-gray-200; }
  @media (max-width: 768px) {
    .card-mobile { @apply rounded-none border-x-0; }
    .card-mobile-header, .card-mobile-content, .card-mobile-footer { @apply px-3; }
  }

  /* Section and Card Spacing */
  .section-padding { @apply px-4 py-6 sm:px-6 sm:py-8 lg:px-8 lg:py-12; }
  .card-padding { @apply p-4 sm:p-6 lg:p-8; }
  .mobile-padding { @apply px-3 py-4 sm:px-4 sm:py-6; }

  /* Mobile-first grids */
  .grid-responsive-1 { @apply grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4; }
  .grid-responsive-2 { @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5; }
  .grid-responsive-auto { @apply grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5; }
  .grid-mobile-compact { @apply grid grid-cols-1 gap-2 sm:gap-3; }
  .grid-mobile-expanded { @apply grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4; }

  /* Forms */
  .form-mobile { @apply space-y-4; }
  .form-mobile .form-group { @apply space-y-2; }
  .form-mobile label { @apply block text-sm font-medium text-gray-700 mb-1; }
  .form-mobile input, .form-mobile select, .form-mobile textarea { @apply w-full px-3 py-2 border border-gray-300 rounded-md text-base; }
  @media (max-width: 768px) { .form-mobile input, .form-mobile select, .form-mobile textarea { @apply text-base py-3; } }

  /* Inputs with icons/prefixes */
  .input-with-icon { @apply relative; }
  .input-with-icon input { @apply pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white; }
  .input-with-icon .input-icon { @apply absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none; }
  .input-prefix { @apply relative; }
  .input-prefix .prefix { @apply absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm; }
  .input-prefix input { @apply pl-10; }
  input::placeholder { @apply text-gray-400 opacity-100; }
  input:focus::placeholder { @apply text-gray-300; }

  /* Toasts y Dropdowns (scoped a data-attrs para evitar fugas) */
  [data-sonner-toast], [data-sonner-toaster] {
    @apply bg-white border border-gray-200 shadow-lg !important;
    background: white !important; backdrop-filter: none !important; opacity: 1 !important;
  }
  [data-sonner-toast][data-type="success"] { @apply bg-green-50 border-green-200 !important; background: rgb(240 253 244) !important; }
  [data-sonner-toast][data-type="error"] { @apply bg-red-50 border-red-200 !important; background: rgb(254 242 242) !important; }
  [data-sonner-toast][data-type="warning"] { @apply bg-yellow-50 border-yellow-200 !important; background: rgb(254 252 232) !important; }

  [data-radix-dropdown-menu-content], [data-radix-select-content], [data-radix-popover-content], [data-radix-dropdown-menu-content] > div, [data-radix-select-content] > div {
    @apply bg-white border border-gray-200 shadow-lg !important;
    background: white !important; backdrop-filter: none !important; background-color: white !important; opacity: 1 !important; 
  }
  [data-radix-popper-content-wrapper], [data-radix-dropdown-menu-content], [data-radix-select-content] {
    @apply transition-none !important; animation: none !important;
  }

  /* Buttons base (opt-in) */
  .btn-befast { @apply inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm font-medium transition-all duration-200 ease-in-out shadow-neumorphic hover:shadow-neumorphic-hover active:shadow-neumorphic-pressed hover:scale-105 active:scale-95; }
  .btn-befast-primary { @apply btn-befast text-white; background-color: var(--befast-primary); }
  .btn-befast-primary:hover { background-color: color-mix(in srgb, var(--befast-primary) 90%, black); }
  .btn-befast-secondary { @apply btn-befast text-white; background-color: var(--befast-secondary); }
  .btn-befast-secondary:hover { background-color: color-mix(in srgb, var(--befast-secondary) 90%, black); }
  .btn-befast-outline { @apply btn-befast bg-background border-2; border-color: var(--befast-primary); color: var(--befast-primary); }
  .btn-befast-outline:hover { background-color: var(--befast-primary); color: white; }
  
  /* Universal Button icon normalization */
  .ui-btn svg { @apply w-4 h-4 flex-shrink-0; }

  .card-befast { @apply rounded-xl bg-background shadow-neumorphic border border-gray-200/30 backdrop-blur-sm; }
  .input-befast { @apply rounded-lg border border-gray-300 bg-background px-3 py-2 text-sm shadow-neumorphism-inset focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-200 ease-in-out; }
  .input-befast:focus { --tw-ring-color: var(--befast-primary); }

  /* Checkbox UI (conservado) */
  .checkbox-wrapper { --checkbox-size: 25px; --checkbox-color: #00ff88; --checkbox-shadow: rgba(0, 255, 136, 0.3); --checkbox-border: rgba(0, 255, 136, 0.7); display: flex; align-items: center; position: relative; cursor: pointer; padding: 10px; }
  .checkbox-wrapper input { position: absolute; opacity: 0; cursor: pointer; height: 0; width: 0; }
  .checkbox-wrapper .checkmark { position: relative; width: var(--checkbox-size); height: var(--checkbox-size); border: 2px solid var(--checkbox-border); border-radius: 8px; transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55); display: flex; justify-content: center; align-items: center; background: rgba(0, 0, 0, 0.2); box-shadow: 0 0 15px var(--checkbox-shadow); overflow: hidden; }
  .checkbox-wrapper .checkmark::before { content: ""; position: absolute; width: 100%; height: 100%; background: linear-gradient(45deg, var(--checkbox-color), #00ffcc); opacity: 0; transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55); transform: scale(0) rotate(-45deg); }
  .checkbox-wrapper input:checked ~ .checkmark::before { opacity: 1; transform: scale(1) rotate(0); }
  .checkbox-wrapper .checkmark svg { width: 0; height: 0; color: #1a1a1a; z-index: 1; transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55); filter: drop-shadow(0 0 2px rgba(0, 0, 0, 0.5)); }
  .checkbox-wrapper input:checked ~ .checkmark svg { width: 18px; height: 18px; transform: rotate(360deg); }
  .checkbox-wrapper:hover .checkmark { border-color: var(--checkbox-color); transform: scale(1.1); box-shadow: 0 0 20px var(--checkbox-shadow), 0 0 40px var(--checkbox-shadow), inset 0 0 10px var(--checkbox-shadow); }
  .checkbox-wrapper input:checked ~ .checkmark { animation: pulse 1s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
  .checkbox-wrapper .label { margin-left: 15px; font-family: "Segoe UI", sans-serif; color: var(--checkbox-color); font-size: 18px; text-shadow: 0 0 10px var(--checkbox-shadow); opacity: 0.9; transition: all 0.3s; }
}

@layer utilities {
  /* Fonts */
  .font-montserrat { font-family: 'Montserrat', sans-serif; }
  .font-headline { font-family: 'Montserrat', sans-serif; font-weight: 700; letter-spacing: -0.025em; }

  /* BeFast color utilities */
  .text-befast-primary { color: var(--befast-primary); }
  .text-befast-secondary { color: var(--befast-secondary); }
  .text-befast-tertiary { color: var(--befast-tertiary); }
  .bg-befast-primary { background-color: var(--befast-primary); }
  .bg-befast-secondary { background-color: var(--befast-secondary); }
  .bg-befast-tertiary { background-color: var(--befast-tertiary); }
  .border-befast-primary { border-color: var(--befast-primary); }
  .border-befast-secondary { border-color: var(--befast-secondary); }
  .border-befast-tertiary { border-color: var(--befast-tertiary); }

  /* Layout helpers */
  .filters-row { @apply w-full flex flex-wrap items-center gap-2 sm:gap-3 overflow-x-auto; }
  .btn-row { @apply w-full flex flex-wrap gap-2 sm:gap-3; }
  .chart-container { @apply relative w-full min-h-64; }
  .safe-area-px { padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left); }
  .overflow-x-screen { @apply -mx-4 px-4 overflow-x-auto; }
  
  /* Hide scrollbar but keep functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;  /* Chrome, Safari and Opera */
  }
}

/* Animations */
@keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
@keyframes pulse-glow { 0% { box-shadow: 0 0 5px rgba(255, 115, 0, 0.5); } 100% { box-shadow: 0 0 20px rgba(255, 115, 0, 0.8), 0 0 30px rgba(22, 87, 240, 0.4); } }
@keyframes neumorphic-pop { 0% { transform: scale(1); box-shadow: 8px 8px 12px -2px rgba(72, 79, 96, 0.4), -6px -6px 12px -1px rgba(255, 255, 255, 1);} 50% { transform: scale(0.98); box-shadow: inset 4px 4px 8px rgba(72, 79, 96, 0.3), inset -4px -4px 8px rgba(255, 255, 255, 0.8);} 100% { transform: scale(1); box-shadow: 12px 12px 20px -4px rgba(72, 79, 96, 0.5), -8px -8px 16px -2px rgba(255, 255, 255, 1);} }
@keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);} 50% { transform: scale(0.9); box-shadow: 0 0 30px rgba(0, 255, 136, 0.3), 0 0 50px rgba(0, 255, 136, 0.3);} 100% { transform: scale(1); box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);} }
